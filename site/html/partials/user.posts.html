<div class="row" ng-repeat="post in posts" ng-controller="Post">
  <div class="col-md-1"></div>
  <div class="col-md-10">
    <div class="panel panel-default">
      <div class="panel-heading">
          <div class="panel-title">

            <div class="row">
              <div class="col-md-9">
                  <a class="h2" ui-sref="user({ username: post.author.username })">
                    {{ post.author.username }}</a>@<a href="#">{{ post.room.name }}</a> said:
              </div>

              <div class="col-md-3">
                {{ post.time }}
                <span ng-if="$storage.user.username == post.author.username">
                  <a href="" ng-click="toggle_editing()"><span class="glyphicon glyphicon-pencil"></span></a>
                  <a href="" ng-click="delete_post()"><span class="glyphicon glyphicon-remove"></span></a>
                </span>
              </div>
            </div>
          </div>
      </div>
      <div class="panel-body">
        <p ng-if="!editing">{{ post.content }}</p>
        <form class="form-inline" ng-if="editing" ng-submit="edit_post()">
          <div class="form-group">
            <textarea rows="1" class="form-control" ng-model="editPost.content" name="content"></textarea>
          </div>
          <button type="submit" class="btn btn-default">Edit</button>
          <button type="button" class="btn btn-default" ng-click="toggle_editing()">Cancel</button>
        </form>

        <p ng-if="!showing"><a href="" ng-click="load_comments()">Show comments</a></p>
        <p ng-if="showing"><a href="" ng-click="remove_comments()">Hide comments</a></p>
      </div>

        <ul class="list-group">
          <li class="list-group-item" ng-repeat="comment in comments" ng-controller="Comment">
          <div class="row">
            <div class="col-md-9">
              <strong>
                <a ui-sref="user({username: comment.author.username})">
                  {{comment.author.username}}
                </a>
              </strong> 
              <span ng-if="!editing">{{ comment.content }}</span>
                <form class="form-inline" ng-if="editing" ng-submit="edit_comment()">
                  <div class="form-group">
                    <textarea rows="1" class="form-control" ng-model="editComment.content" name="content"></textarea>
                  </div>
                  <button type="submit" class="btn btn-default">Edit</button>
                  <button type="button" class="btn btn-default" ng-click="toggle_editing()">Cancel</button>
                </form>
            </div>

            <div class="col-md-3">
              {{comment.time}}
              <span ng-if="$storage.user.username == comment.author.username">
                <a href="" ng-click="toggle_editing()"><span class="glyphicon glyphicon-pencil"></span></a>
                <a href="" ng-click="delete_comment()"><span class="glyphicon glyphicon-remove"></span></a>
              </span>
            </div>
          </div>
          </li>

          <p class="text-center"><a href="" ng-click="next_page()" ng-if="next">Show more</a></p>
      </ul>

      <form class="form-inline" ng-submit="submit()">
        <div class="form-group">
          <textarea rows="1" class="form-control" ng-model="comment.content" name="content" placeholder="Comment..."></textarea>
        </div>
        <button type="submit" class="btn btn-default">Comment</button>
      </form>      
    </div>
  </div>
  <div class="col-md-1"></div>
</div>

<div>
  <p class="text-center"><a href="" ng-click="next_page()" ng-if="next">Show more</a></p>
</div>